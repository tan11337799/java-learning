# **计算机网络**

OSI 7层参考模型：(未实现)物理层 链路层 网络层 传输控制层 会话层 表示层 应用层



TCP/IP模型： 物理层 链路层 网络层 传输控制层 应用层（三合一）

注意点：前四层由于大体一致因此由**内核**实现，应用层通常追求个性化因此由**程序**实现



四次分手：

1、任一方发送fin

2、对方回复fin+ack（表示收到）

3、对方再次发送fin表示确认分手

4、任一方回复ack表示确认



## HTTP协议

在浏览器输入域名A之后的底层机制：

1. 查询浏览器的DNS缓存是否存在A的IP映射；
2. 如果浏览器中没有，则会在操作系统中查询DNS缓存；
3. 如果1和2都没查询到，则读取硬盘中的host文件，查询映射关系；
4. 浏览器（客户端）向服务器发起DNS解析请求（递归名称解析、迭代名称解析），获取A的IP地址；
5. 通过IP地址，浏览器向该服务器建立TCP连接（三次握手）；
6. 建立连接，浏览器向服务器发起HTTP请求（如访问A的首页、向服务器发起GET请求）；
7. 服务器接收到请求后，根据路径参数，进行后台处理，将处理结果返回浏览器（如返回HTML页面代码）；
8. 浏览器根据HTML页面代码，利用内核和JS引擎解析和渲染页面，页面中的静态资源也通过HTTP请求进行加载，将页面呈现给用户；
9. 浏览器向服务器发起TCP断开（四次握手）；



#### **基本概念**

HTTP，全称HyperText Transfer Protocol，即为超文本传输协议。是互联网应用最为广泛的一种网络协议，所有的www文件都必须遵守这个标准。

**特性：**

（1）无连接无状态；（2）构建于TCP/IP协议之上，默认端口为80。

**步骤：**请求 + 响应

#### **HTTP 请求**

HTTP 定义了在与服务器交互的不同方式，最常用的方法有 4 种，分别是 GET，POST，PUT， DELETE。URL 全称为资源描述符，可以这么认为：一个 URL 地址，对应着一个网络上的资源，而 HTTP 中的GET，POST，PUT，DELETE就对应着对这个资源的查询，修改，增添，删除4个操作。

举例：

![1653663753364](C:\Users\tan\AppData\Roaming\Typora\typora-user-images\1653663753364.png)

HTTP请求分为 3 个部分：**状态行，请求头(Request Header)，请求正文**

* 状态行由请求方式，路径、协议等构成，各元素之间以空格分隔。对应到图中即为 GET、/books/?sex=man&name=Professional、 HTTP/1.1

* 请求头提供一些参数比如：Cookie，用户代理信息，主机名等等。(图中即从第二行到最后一行)

* 请求正文就放一些发送的数据，一般 GET 请求会将参数放在 URL 中，也就是在请求头中而请求正文一般为空，而 POST 请求将参数放在请求正文中。请求正文可以传一些 json 数据或者字符串等等。

**GET请求**

GET 一般用于信息获取，比如刚才我们浏览百度首页，其使用的就是GET方法。

GET 请求一般不会产生副作用，它仅仅只是获取资源信息，就像数据库查询一样，不会修改、增加数据，不会影响资源的状态，并且对同一个 URL 的多次GET请求应该返回相同的结果。

**POST请求**

 POST 请求表示可能会修改服务器上的资源。

**GET 请求和 POST 请求的区别**

1. GET 和 POST 请求参数位置不同，从上面两个请求报文可以看出，GET 请求对应的参数放在 URL 中，而 POST 请求对应的参数放在 HTTP 请求主体中。(但是这只是一种约定，GET 请求中出现 Body 也是被允许的)
2. 虽然 HTTP 协议的RFC规范并没有详细规定 URL 的最大字符长度限制，但实际上，在浏览器或者服务器中总会存在限制的，这就导致了 GET 请求中参数数量是有限的。
3. 处于安全考虑，在一些涉及安全的请求比如：登录请求需要用 POST 提交表单，而GET 请求一般用来获取静态资源。
4. GET 请求可以被缓存，可以被收藏为书签，但 POST 可以被缓存，但不能被收藏为书签。
5. GET 请求的参数在 URL 中，因此绝不能用 GET 请求传输敏感数据。POST 请求数据则写在 HTTP 的请求头中，安全性略高于 GET 请求。

#### HTTP 响应

HTTP 响应是服务器在客户端发送 HTTP 请求后经过一些处理而做出的响应，HTTP 响应和 HTTP 请求相似，也是由三个部分构成。分别是：状态行，响应头(Response Header)，响应正文。

举例：

![1653666426580](D:\WorkSpace\Notes\Using\assets\1653666426580.png)

**状态码**

状态码一般由3位构成：

- 1xx : 表示请求已经接受了，继续处理。
- 2xx : 表示请求已经处理掉了。
- 3xx : 重定向。
- 4xx : 一般表示客户端有错误，请求无法实现。
- 5xx : 一般为服务器端的错误。

**常见举例**

- 200 OK [客户端](https://www.zhihu.com/search?q=%E5%AE%A2%E6%88%B7%E7%AB%AF&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22article%22%2C%22sourceId%22%3A%2224913080%22%7D)请求成功。 
- 301 Moved Permanently 请求永久重定向。
- 302 Moved Temporarily 请求临时重定向。
- 304 Not Modified 文件未修改，可以直接使用缓存的文件。
- 400 Bad Request 由于客户端请求有语法错误，不能被服务器所理解。
- 401 Unauthorized 请求未经授权，无法访问。
- 403 Forbidden 服务器收到请求，但是拒绝提供服务。服务器通常会在响应正文中给出不提供服务的原因。
- 404 Not Found 请求的资源不存在，比如输入了错误的URL。
- 500 Internal Server Error 服务器发生不可预期的错误，导致无法完成客户端的请求。
- 503 Service Unavailable 服务器当前不能够处理客户端的请求，在一段时间之后，服务器可能会恢复正常。

